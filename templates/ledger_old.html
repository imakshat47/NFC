<!DOCTYPE html>
<html lang="en" class="">
  <head>
    <meta charset="utf-8" />
    <meta name="referrer" content="origin" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta
      name="apple-itunes-app"
      content="app-id=458023433, app-argument=splitwise://open"
    />
    <meta
      name="description"
      content="NFC is a free tool for friends and roommates to track bills and other shared expenses, so that everyone gets paid back. On the web, iPhone, and Android!"
    />
    <meta name="color-scheme" content="light only" />

    <meta
      property="og:description"
      content="NFC is a free tool for friends and roommates to track bills and other shared expenses, so that everyone gets paid back. On the web, iPhone, and Android!"
    />
    <meta property="og:title" content="Log in" />
    <meta
      property="og:image"
      content="https://assets.splitwise.com/assets/core/open-graph-preview-c1b55b0dc7c2b2d5bd6f40bbe34989f3eb2317843246727606cf3e96ee254609.png"
    />
    <meta
      property="og:image:secure_url"
      content="https://assets.splitwise.com/assets/core/open-graph-preview-c1b55b0dc7c2b2d5bd6f40bbe34989f3eb2317843246727606cf3e96ee254609.png"
    />
    <meta property="og:image:alt" content="Splitwise logo" />
    <meta property="og:site_name" content="Splitwise" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://secure.splitwise.com/login" />
    <meta property="fb:app_id" content="293864780643203" />
    <meta property="og:locale" content="en" />
    <meta property="og:locale:alternate" content="de" />
    <meta property="og:locale:alternate" content="es" />
    <meta property="og:locale:alternate" content="fr" />
    <meta property="og:locale:alternate" content="id" />
    <meta property="og:locale:alternate" content="it" />
    <meta property="og:locale:alternate" content="ja" />
    <meta property="og:locale:alternate" content="nl" />
    <meta property="og:locale:alternate" content="pt-BR" />
    <meta property="og:locale:alternate" content="pt-PT" />
    <meta property="og:locale:alternate" content="sv" />
    <meta property="og:locale:alternate" content="th" />
    <meta property="og:locale:alternate" content="emoji" />

    <meta name="twitter:card" content="app" />
    <meta
      name="twitter:description"
      content="Splitwise is a free tool for friends and roommates to track bills and other shared expenses, so that everyone gets paid back. On the web, iPhone, and Android!"
    />
    <meta name="twitter:site" content="@splitwise" />
    <meta name="twitter:app:name:iphone" content="Splitwise" />
    <meta name="twitter:app:id:iphone" content="458023433" />
    <meta name="twitter:app:name:googleplay" content="Splitwise" />
    <meta
      name="twitter:app:id:googleplay"
      content="com.Splitwise.SplitwiseMobile"
    />

    <meta name="csrf-param" content="authenticity_token" />
    <meta
      name="csrf-token"
      content="Pejp1c-ddlc7xQ_gwYW0mwT62AwZKppr1xvsldRS7tXgk_zdMzCG1x1ou7ECKrzY-sVFqwu-6Wy4AL7aSv9J1Q"
    />

    <link
      rel="stylesheet"
      href="https://assets.splitwise.com/assets/motel-82ff5aea486b5a67c66619aefa9df389a82561c946813551bfee5ed0175bf3a8.css"
      media="all"
    />
    <link
      href="https://fonts.googleapis.com/css?family=Lato:400,400i,700|Montserrat:400,600,700&display=swap"
      rel="stylesheet"
    />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link
      rel="apple-touch-icon-precomposed"
      href="/apple-touch-icon-precomposed.png"
    />

    <link rel="canonical" href="https://www.splitwise.com/login" />

    <script type="importmap" data-turbo-track="reload">
      {
        "imports": {
          "application": "https://assets.splitwise.com/assets/application-e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.js",
          "motel": "https://assets.splitwise.com/assets/motel-9680a85d72b6e12cc54519efa8506651b42f5a043ce30bc3c73bf48ba8af53a7.js",
          "motel/motel": "https://assets.splitwise.com/assets/motel/motel-c75db22451adcb1f5d0420f4cad79acafbb541772a3771da2be4cca996d1fd6d.js",
          "charts": "https://assets.splitwise.com/assets/charts-1f38e9276acc590cf23ffc67fb3514a8af03f73a7a02a68981883c97934a1d9f.js",
          "chartkick": "https://assets.splitwise.com/assets/chartkick-338375253bd80b2f0da7e8b98ae0194bb84ea647cae7d3a2fec94a8cc15f7578.js",
          "Chart.bundle": "https://assets.splitwise.com/assets/Chart.bundle-93c2270a882e090c5eaceec7a74e8cc7c4e02f7dde0951148b83f9a0be5c8dbb.js",
          "@rails/ujs": "https://assets.splitwise.com/assets/@rails--ujs-57169a955c1531a628bf30afac33de3edd70cec551c6262363e9915d750c3f6d.js",
          "@github/webauthn-json/browser-ponyfill": "https://assets.splitwise.com/assets/@github--webauthn-json--browser-ponyfill-c940892aa19f632b24b0ce6709282eceeed185222b9fda7902b0ec9bd72ce954.js"
        }
      }
    </script>

    <script
      src="https://assets.splitwise.com/assets/es-module-shims.min-f6e61a1a9f41be4f7947efa52fef6f0b9b265d4a397ce46d39a09e1c1d044578.js"
      async="async"
      data-turbo-track="reload"
    ></script>
    <script type="module">
      import "application";
    </script>
    <script type="module">
      import "motel";
    </script>
    <style>
      .dashboard {
        display: flex;
        flex-direction: column;
        align-items: center;
        background-color: hsl(120, 67%, 96%);
        border-radius: 10px;
        box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.2);
        padding: 20px;
        max-width: 800px;
        width: 90%;
        margin: 20px auto;
      }

      .circle {
        background-color: hsl(122, 47%, 71%);
        border-radius: 50%;
        width: 200px;
        height: 200px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        margin-bottom: 20px;
        box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.2);
      }

      .circle h2 {
        margin: 0;
        font-size: 1.2rem;
      }

      .circle h1 {
        margin: 5px 0;
        font-size: 2.5rem;
      }

      .circle p {
        margin: 0;
        font-size: 1rem;
      }

      .info {
        width: 100%;
        text-align: left;
      }

      .title {
        margin: 0 0 10px;
        font-size: 2rem;
        font-weight: bold;
      }

      .info p {
        margin: 5px 0;
        font-size: 1rem;
      }

      .info p span {
        font-weight: bold;
      }

      .note {
        margin-top: 10px;
        font-size: 1rem;
        font-weight: bold;
        color: #e8f5e9;
      }

      .buttons {
        margin-top: 20px;
        display: flex;
        justify-content: space-between;
        gap: 10px;
      }

      .btn {
        border: none;
        padding: 10px 20px;
        font-size: 1rem;
        border-radius: 5px;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .btn-primary {
        background-color: #2e7d32;
        color: #fff;
      }

      .btn-primary:hover {
        background-color: #1b5e20;
      }

      .btn-secondary {
        background-color: #ffffff;
        color: #4caf50;
      }

      .btn-secondary:hover {
        background-color: #f1f1f1;
      }

      .table {
            border-collapse: collapse !important;
        }
        .table th {
            background-color: #212529 !important;
            color: #ffffff !important;
            text-align: center !important;
        }
        .table td {
            text-align: center !important;
        }
        .table tbody tr:hover {
            background-color: #f1f3f5 !important;
        }
        .table tbody tr:nth-child(even) {
            background-color: #f8f9fa !important;
        }
        .btn-refresh {
            display: inline-block;
            margin: 20px auto;
            text-align: center;
            cursor: pointer;
        }
        .btn-refresh button {
            background-color: #198754;
            color: #fff;
            border: none;
            padding: 8px 16px;
            font-size: 16px;
            border-radius: 4px;
            transition: all 0.3s;
        }
        .btn-refresh button:hover {
            background-color: #157347;
            color: #ffffff;
        }
    </style>
  </head>
  <body class="font-sans subpixel-antialiased login">
    <!-- Outer Container -->
    <div class="container mx-auto">
      <!-- Include Header -->
      {% include 'header_login.html' %}
    </div>

    <main class="bg-facets">
      <!-- Main Content Container -->
      <div class="container mx-auto px-4 md:px-8 pt-8">
        <!-- Flex Wrapper for Center Alignment -->
        <div class="lg:flex lg:items-center lg:justify-center">
          <!-- Modal Box Wrapper -->
          <div
            class="lg:w-1/2 xl:w-1/2 modal_box bg-white p-8 rounded-lg shadow-md"
          >
          
            <!-- Dashboard Content -->
            <div class="dashboard text-center">

                <div class="ledger-header">
                    <h2><i class="fas fa-book"></i> Transaction Ledger</h2>
                    <p>Your approved transactions are displayed here.</p>
                </div>

                <div class="container">
                    
                    <div id="ledger-container">
                        <div class="table-container">
                            <table class="table table-bordered table-hover">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>From</th>
                                        <th>Type</th>
                                        <th>Amount (â‚¹)</th>
                                        <th>To</th>
                                    </tr>
                                </thead>
                                <tbody id="ledger-table-body">
                                   Rows will be dynamically inserted here 
                                </tbody>
                            </table>
                        </div>
                        <div class="btn-refresh text-center">
                            <button onclick="fetchLedger()"><i class="fas fa-sync-alt"></i> Refresh</button>
                        </div>
                    </div>
                </div>
            

                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- Footer Section -->
    <div class="container mx-auto mt-8">{% include 'footer.html' %}</div>
    <script>
      // Fetch and display the ledger data
      async function fetchLedger() {
          try {
              const response = await fetch('/ledger', { method: 'GET' });
              const data = await response.json();

              if (response.ok) {
                  const tableBody = document.getElementById('ledger-table-body');
                  tableBody.innerHTML = '';

                  data.forEach(transaction => {
                      const row = document.createElement('tr');
                      row.innerHTML = `
                          <td>${new Date(transaction.date).toLocaleString()}</td>
                          <td>${transaction.from_user}</td>
                          <td>${transaction.type.charAt(0).toUpperCase() + transaction.type.slice(1)}</td>
                          <td>â‚¹${transaction.amount.toLocaleString('en-IN')}</td>
                          <td>${transaction.to_user}</td>
                      `;
                      tableBody.appendChild(row);
                  });

                  if (data.length === 0) {
                      const row = document.createElement('tr');
                      row.innerHTML = `<td colspan="5" class="text-center text-muted">No approved transactions found.</td>`;
                      tableBody.appendChild(row);
                  }
              } else {
                  alert('Error fetching transactions: ' + (data.message || 'Unknown error.'));
              }
          } catch (error) {
              console.error('Error fetching ledger:', error);
          }
      }

      // Fetch ledger on page load
      document.addEventListener('DOMContentLoaded', fetchLedger);
  </script>
  </body>
</html>

    